## RPC 관련 치트코드

### 시그니처

```solidity
// 구성된 별칭에 대한 URL을 반환합니다.
function rpcUrl(string calldata alias) external returns (string memory);
// 모든 구성된 (별칭, URL) 쌍을 반환합니다.
function rpcUrls() external returns(string[2][] memory);
/// 현재 포크 URL에 이더리움 JSON-RPC 요청을 수행합니다.
function rpc(string calldata method, string calldata params) external returns (bytes memory data);
```

### 설명

`foundry.toml`의 `rpc_endpoints` 객체에 구성된 모든 RPC 엔드포인트에 액세스하는 치트코드와 구성된 포크 URL을 사용하여 `rpc` 호출을 수행하는 기능을 제공합니다.

### 예제

`foundry.toml`의 다음 `rpc_endpoints`는 두 개의 RPC 별칭을 등록합니다:

- `optimism`은 URL을 직접 참조합니다.
- `mainnet`은 실제 URL을 포함할 것으로 예상되는 `RPC_MAINNET` 환경 값을 참조합니다.

_환경 변수는 `${}`로 감싸야 합니다._

```toml
# --snip--
[rpc_endpoints]
optimism = "https://optimism.alchemyapi.io/v2/..."
mainnet = "${RPC_MAINNET}"
```

```solidity
string memory url = vm.rpcUrl("optimism");
assertEq(url, "https://optimism.alchemyapi.io/v2/...");
```

환경 변수가 누락된 경우 `rpcUrl()`은 리버트됩니다:

```solidity
vm.expectRevert("Failed to resolve env var `${RPC_MAINNET}` in `RPC_MAINNET`: environment variable not found");
string memory url = vm.rpcUrl("mainnet");
```

사용 가능한 모든 별칭 -> URL 쌍 검색

```solidity
string[2][] memory allUrls = vm.rpcUrls();
assertEq(allUrls.length, 2);

string[2] memory val = allUrls[0];
assertEq(val[0], "optimism");

string[2] memory env = allUrls[1];
assertEq(env[0], "mainnet");
```

`eth_getBalance`에 대한 RPC 호출 수행

```solidity
// balance at block <https://etherscan.io/block/18332681>
bytes memory result = vm.rpc("eth_getBalance", "[\"0x8D97689C9818892B700e27F316cc3E41e17fBeb9\", \"0x117BC09\"]")
assertEq(hex"10b7c11bcb51e6", result);
```

### 같이 보기

Forge 설정

[설정 참조](/config/reference/testing#rpc_endpoints)
